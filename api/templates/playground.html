<!DOCTYPE html><html><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com https://text.pollinations.ai; connect-src 'self' https://text.pollinations.ai; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;"><meta http-equiv="x-dns-prefetch-control" content="off"><meta name="x-poe-datastore-behavior" content="disabled"><meta name="x-poe-allow-downloads" content="true"><script src="https://puc.poecdn.net/standard.25f6d5ebb7608dc2f276.js"></script>
    <meta charset="utf-8">
    <title>Pandex Agent</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='icon.png') }}">
    <meta name="viewport" content="width=device-width,initial-scale=1">
  <script src="https://puc.poecdn.net/disableWebRTC.9710cebe07429a9e8e06.js"></script><script src="https://puc.poecdn.net/tw.b9024aecac666455e183.js"></script><script src="https://puc.poecdn.net/deps.faccd16000d314dc16d5.js"></script><script src="https://puc.poecdn.net/exports.b0f0f482cdeb5302b0b9.js"></script><script src="https://puc.poecdn.net/renderer.75c73ae6b4235f62945a.js"></script><script>Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _react = require('react'); var _react2 = _interopRequireDefault(_react);
var _lucidereact = require('lucide-react');

const PandexAgentEditor = () => {
  // Default example hub with new output structure
  const defaultHub = {
    agents: {
      "simple": {
        "template": "[[PROMPT]]",
        "executor": {
          "type": "api",
          "url": "https://text.pollinations.ai/openai",
          "headers": {"Content-Type": "application/json"},
          "data": {"model": "deepseek", "prompt": "Hello world."}
        },
        "output": {
          "type": "raw",
        },
        "vars": {
          "prompt": {
            "type": "text",
            "default": "Hello world."
          }
        }
      }
    }
  };

  const [hubConfig, setHubConfig] = _react.useState.call(void 0, defaultHub);
  const [selectedAgent, setSelectedAgent] = _react.useState.call(void 0, 'simple');
  const [selectedField, setSelectedField] = _react.useState.call(void 0, null);
  const [mode, setMode] = _react.useState.call(void 0, 'edit');
  const [executionResult, setExecutionResult] = _react.useState.call(void 0, null);
  const [isExecuting, setIsExecuting] = _react.useState.call(void 0, false);
  const [rightPanelView, setRightPanelView] = _react.useState.call(void 0, 'field'); // 'field', 'execution', 'json'
  
  // Generation states
  const [generateType, setGenerateType] = _react.useState.call(void 0, 'agent'); // 'hub' or 'agent'
  const [generatePrompt, setGeneratePrompt] = _react.useState.call(void 0, '');
  const [isGenerating, setIsGenerating] = _react.useState.call(void 0, false);
  
  // UI states
  const [showAgentModal, setShowAgentModal] = _react.useState.call(void 0, false);
  const [agentModalType, setAgentModalType] = _react.useState.call(void 0, 'add'); // 'add' or 'edit'
  const [editingAgent, setEditingAgent] = _react.useState.call(void 0, null);
  const [agentSearch, setAgentSearch] = _react.useState.call(void 0, '');
  
  // Variable modal states
  const [showVariableModal, setShowVariableModal] = _react.useState.call(void 0, false);
  const [variableModalType, setVariableModalType] = _react.useState.call(void 0, 'add'); // 'add' or 'edit'
  const [editingVariable, setEditingVariable] = _react.useState.call(void 0, null);

  // Output key modal states
  const [showOutputKeyModal, setShowOutputKeyModal] = _react.useState.call(void 0, false);
  const [outputKeyModalType, setOutputKeyModalType] = _react.useState.call(void 0, 'add'); // 'add' or 'edit'
  const [editingOutputKey, setEditingOutputKey] = _react.useState.call(void 0, null);

  // Execution status tracking
  const [executionStatus, setExecutionStatus] = _react.useState.call(void 0, null);
  const [statusPolling, setStatusPolling] = _react.useState.call(void 0, null);

  // Example hub states
  const [availableExamples, setAvailableExamples] = _react.useState.call(void 0, ['default']);
  const [selectedExample, setSelectedExample] = _react.useState.call(void 0, 'default');
  const [isLoadingExample, setIsLoadingExample] = _react.useState.call(void 0, false);

  const currentAgent = hubConfig.agents[selectedAgent] || {};

  // Load available examples on component mount
  _react.useEffect.call(void 0, () => {
    loadAvailableExamples();
  }, []);

  const loadAvailableExamples = async () => {
    try {
      // Try to fetch the list of example files from the server
      const response = await fetch('/api/examples');
      if (response.ok) {
        const examples = await response.json();
        setAvailableExamples(['default', ...examples]);
      }
    } catch (error) {
      console.log('Could not load examples from server, using default only');
      // Fallback to just the default example
      setAvailableExamples(['default']);
    }
  };

  const loadExample = async (exampleName) => {
    if (exampleName === selectedExample) return;
    
    setIsLoadingExample(true);
    try {
      if (exampleName === 'default') {
        // Load the default hub
        setHubConfig(defaultHub);
        setSelectedAgent('simple');
      } else {
        // Try to load from static/examples/ folder
        const response = await fetch(`/static/examples/${exampleName}.json`);
        if (response.ok) {
          const exampleHub = await response.json();
          setHubConfig(exampleHub);
          // Select the first agent in the loaded hub
          const firstAgent = Object.keys(exampleHub.agents)[0];
          if (firstAgent) {
            setSelectedAgent(firstAgent);
          }
        } else {
          throw new Error(`Could not load example: ${exampleName}`);
        }
      }
      setSelectedExample(exampleName);
      setSelectedField(null);
      setRightPanelView('field');
    } catch (error) {
      console.error('Error loading example:', error);
      alert(`Failed to load example "${exampleName}". Please check if the file exists.`);
    } finally {
      setIsLoadingExample(false);
    }
  };

  // Helper function to extract JSON from text response
  const extractJsonFromText = (text) => {
    try {
      // First try to parse the entire text as JSON
      return JSON.parse(text);
    } catch (e) {
      // If that fails, try to find JSON within the text
      const jsonMatch = text.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        try {
          return JSON.parse(jsonMatch[0]);
        } catch (e2) {
          // If still fails, create a simple structure from the text
          return null;
        }
      }
      return null;
    }
  };

  // Helper function to create agent from AI response
  const createAgentFromResponse = (response, userPrompt) => {
    const extractedJson = extractJsonFromText(response);
    
    if (extractedJson && extractedJson.template) {
      return extractedJson;
    }
    
    // Fallback: create agent structure from text response
    const agentName = `ai_generated_${Date.now()}`;
    const variables = [];
    
    // Extract potential variables from the response
    const variableMatches = response.match(/\[\[([A-Z_]+)\]\]/g);
    if (variableMatches) {
      variableMatches.forEach(match => {
        const varName = match.replace(/\[\[|\]\]/g, '').toLowerCase();
        if (!variables.includes(varName)) {
          variables.push(varName);
        }
      });
    }
    
    // If no variables found, add a default one
    if (variables.length === 0) {
      variables.push('input');
    }
    
    const vars = {};
    variables.forEach(varName => {
      vars[varName] = {
        type: "text",
        default: "Enter value here"
      };
    });
    
    return {
      template: response.includes('[[') ? response : `${response}. Input: [[INPUT]]`,
      executor: {
        type: "api",
        url: "https://api.example.com/generated",
        headers: { "Content-Type": "application/json" },
        data: { purpose: userPrompt }
      },
      output: {
        type: "json",
        keys: {
          "output": {
            "type": "string",
            "description": "Main output"
          },
          "status": {
            "type": "int",
            "description": "Status code"
          }
        }
      },
      vars: vars
    };
  };

  // Helper function to create hub from AI response
  const createHubFromResponse = (response, userPrompt) => {
    const extractedJson = extractJsonFromText(response);
    
    if (extractedJson && extractedJson.agents) {
      return extractedJson;
    }
    
    // Fallback: create hub structure from text response
    const lines = response.split('\n').filter(line => line.trim());
    const agents = {};
    
    // Try to extract agent descriptions from the response
    let agentCount = 1;
    lines.forEach((line, index) => {
      if (line.length > 10 && !line.startsWith('```')) {
        const agentName = `agent_${agentCount}`;
        agents[agentName] = {
          template: `${line}. Process: [[INPUT]]`,
          executor: {
            type: "api",
            url: "https://api.example.com/generated",
            headers: { "Content-Type": "application/json" },
            data: { purpose: line }
          },
          output: {
            type: "json",
            keys: {
              "output": {
                "type": "string",
                "description": "Main output"
              },
              "status": {
                "type": "int",
                "description": "Status code"
              }
            }
          },
          vars: {
            input: {
              type: "text",
              default: "Enter input here"
            }
          }
        };
        agentCount++;
      }
    });
    
    // If no agents created, create a default one
    if (Object.keys(agents).length === 0) {
      agents[`generated_hub_${Date.now()}`] = {
        template: `Hub for: ${userPrompt}. Process: [[INPUT]]`,
        executor: {
          type: "api",
          url: "https://api.example.com/generated",
          headers: { "Content-Type": "application/json" },
          data: { purpose: userPrompt }
        },
        output: {
          type: "json",
          keys: {
            "output": {
              "type": "string",
              "description": "Main output"
            },
            "status": {
              "type": "int",
              "description": "Status code"
            }
          }
        },
        vars: {
          input: {
            type: "text",
            default: "Enter input here"
          }
        }
      };
    }
    
    return { agents };
  };

  // Output Key Modal Component
  const OutputKeyModal = () => {
    const [keyName, setKeyName] = _react.useState.call(void 0, '');
    const [keyType, setKeyType] = _react.useState.call(void 0, 'string');
    const [keyDescription, setKeyDescription] = _react.useState.call(void 0, '');
    
    _react.useEffect.call(void 0, () => {
      if (outputKeyModalType === 'edit' && editingOutputKey && currentAgent.output?.keys?.[editingOutputKey]) {
        const keyConfig = currentAgent.output.keys[editingOutputKey];
        setKeyName(editingOutputKey);
        setKeyType(keyConfig.type || 'string');
        setKeyDescription(keyConfig.description || '');
      } else {
        setKeyName('');
        setKeyType('string');
        setKeyDescription('');
      }
    }, [outputKeyModalType, editingOutputKey, currentAgent]);

    const handleSave = () => {
      if (!keyName.trim()) {
        alert('Please enter a key name');
        return;
      }

      if (outputKeyModalType === 'add' && currentAgent.output?.keys?.[keyName]) {
        alert('Key name already exists');
        return;
      }

      const newOutput = { ...currentAgent.output };
      if (!newOutput.keys) {
        newOutput.keys = {};
      }
      
      const newKeys = { ...newOutput.keys };
      
      // If editing and name changed, remove old key
      if (outputKeyModalType === 'edit' && editingOutputKey && keyName !== editingOutputKey) {
        delete newKeys[editingOutputKey];
      }

      newKeys[keyName] = {
        type: keyType,
        description: keyDescription
      };

      newOutput.keys = newKeys;
      updateAgent('output', newOutput);
      
      setShowOutputKeyModal(false);
      setEditingOutputKey(null);
    };

    const handleClose = () => {
      setShowOutputKeyModal(false);
      setEditingOutputKey(null);
    };

    return (
      _react2.default.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"       ,}
        , _react2.default.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4"      ,}
          , _react2.default.createElement('div', { className: "flex items-center justify-between mb-6"   ,}
            , _react2.default.createElement('h2', { className: "text-xl font-bold text-gray-900"  ,}
              , outputKeyModalType === 'add' ? 'Add Output Key' : 'Edit Output Key'
            )
            , _react2.default.createElement('button', {
              onClick: handleClose,
              className: "p-2 hover:bg-gray-100 rounded-lg transition-colors"   ,}

              , _react2.default.createElement(_lucidereact.X, { className: "w-5 h-5 text-gray-500"  ,} )
            )
          )

          , _react2.default.createElement('div', { className: "space-y-4",}
            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Key Name"

              )
              , _react2.default.createElement('input', {
                type: "text",
                value: keyName,
                onChange: (e) => setKeyName(e.target.value),
                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
                placeholder: "Enter key name (e.g., content)"    ,
                autoFocus: true,}
              )
            )

            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Type")
              , _react2.default.createElement(CustomDropdown, {
                value: keyType,
                onChange: setKeyType,
                options: [
                  { value: 'string', label: 'String', icon: _lucidereact.FileText },
                  { value: 'int', label: 'Integer', icon: _lucidereact.Hash },
                  { value: 'bool', label: 'Boolean', icon: _lucidereact.ToggleLeft },
                  { value: 'array', label: 'Array', icon: _lucidereact.List },
                  { value: 'object', label: 'Object', icon: _lucidereact.Braces }
                ],}
              )
            )

            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Description"

              )
              , _react2.default.createElement('input', {
                type: "text",
                value: keyDescription,
                onChange: (e) => setKeyDescription(e.target.value),
                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
                placeholder: "Enter description for this key"  ,}
              )
            )
          )

          , _react2.default.createElement('div', { className: "flex space-x-3 mt-6"  ,}
            , _react2.default.createElement('button', {
              onClick: handleClose,
              className: "flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"       ,}
, "Cancel"

            )
            , _react2.default.createElement('button', {
              onClick: handleSave,
              className: "flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors"       ,}

              , outputKeyModalType === 'add' ? 'Add Key' : 'Update Key'
            )
          )
        )
      )
    );
  };

  // Variable Modal Component
  const VariableModal = () => {
    const [varName, setVarName] = _react.useState.call(void 0, '');
    const [varType, setVarType] = _react.useState.call(void 0, 'text');
    const [defaultValue, setDefaultValue] = _react.useState.call(void 0, '');
    const [agentName, setAgentName] = _react.useState.call(void 0, '');
    const [selectedKey, setSelectedKey] = _react.useState.call(void 0, '');
    const [plan, setPlan] = _react.useState.call(void 0, '{}');
    
    _react.useEffect.call(void 0, () => {
      if (variableModalType === 'edit' && editingVariable && currentAgent.vars[editingVariable]) {
        const varConfig = currentAgent.vars[editingVariable];
        setVarName(editingVariable);
        setVarType(varConfig.type || 'text');
        setDefaultValue(varConfig.default || '');
        setAgentName(varConfig.agent || '');
        setSelectedKey(varConfig.key || '');
        setPlan(JSON.stringify(varConfig.plan || {}, null, 2));
      } else {
        setVarName('');
        setVarType('text');
        setDefaultValue('');
        setAgentName('');
        setSelectedKey('');
        setPlan('{}');
      }
    }, [variableModalType, editingVariable, currentAgent]);

    const handleSave = () => {
      if (!varName.trim()) {
        alert('Please enter a variable name');
        return;
      }

      if (variableModalType === 'add' && currentAgent.vars[varName]) {
        alert('Variable name already exists');
        return;
      }

      let parsedPlan = {};
      if (varType === 'agent') {
        try {
          parsedPlan = JSON.parse(plan);
        } catch (err) {
          alert('Invalid JSON in plan field');
          return;
        }
      }

      const newVars = { ...currentAgent.vars };
      
      // If editing and name changed, remove old variable
      if (variableModalType === 'edit' && editingVariable && varName !== editingVariable) {
        delete newVars[editingVariable];
      }

      // Create new variable config
      const varConfig = { 
        type: varType
      };
      
      if (varType === 'text') {
        varConfig.default = defaultValue;
      } else if (varType === 'agent') {
        if (agentName) varConfig.agent = agentName;
        if (selectedKey) varConfig.key = selectedKey;
        if (Object.keys(parsedPlan).length > 0) varConfig.plan = parsedPlan;
      }

      newVars[varName] = varConfig;
      updateAgent('vars', newVars);
      
      setShowVariableModal(false);
      setEditingVariable(null);
    };

    const handleClose = () => {
      setShowVariableModal(false);
      setEditingVariable(null);
    };

    // Get available keys from selected agent
    const getAvailableKeys = () => {
      if (!agentName || !hubConfig.agents[agentName]) {
        return [];
      }
      return Object.keys(hubConfig.agents[agentName].output?.keys || {});
    };

    return (
      _react2.default.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"       ,}
        , _react2.default.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4"      ,}
          , _react2.default.createElement('div', { className: "flex items-center justify-between mb-6"   ,}
            , _react2.default.createElement('h2', { className: "text-xl font-bold text-gray-900"  ,}
              , variableModalType === 'add' ? 'Add New Variable' : 'Edit Variable'
            )
            , _react2.default.createElement('button', {
              onClick: handleClose,
              className: "p-2 hover:bg-gray-100 rounded-lg transition-colors"   ,}

              , _react2.default.createElement(_lucidereact.X, { className: "w-5 h-5 text-gray-500"  ,} )
            )
          )

          , _react2.default.createElement('div', { className: "space-y-4",}
            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Variable Name"

              )
              , _react2.default.createElement('input', {
                type: "text",
                value: varName,
                onChange: (e) => setVarName(e.target.value),
                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
                placeholder: "Enter variable name (e.g., user_input)"    ,
                autoFocus: true,}
              )
            )

            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Type")
              , _react2.default.createElement(CustomDropdown, {
                value: varType,
                onChange: setVarType,
                options: [
                  { value: 'text', label: 'Text', icon: _lucidereact.FileText },
                  { value: 'agent', label: 'Agent', icon: _lucidereact.Users }
                ],}
              )
            )

            , varType === 'text' && (
              _react2.default.createElement('div', null
                , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Default Value"

                )
                , _react2.default.createElement('input', {
                  type: "text",
                  value: defaultValue,
                  onChange: (e) => setDefaultValue(e.target.value),
                  className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
                  placeholder: "Enter default value"  ,}
                )
              )
            )

            , varType === 'agent' && (
              _react2.default.createElement(_react2.default.Fragment, null
                , _react2.default.createElement('div', null
                  , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Agent Name"

                  )
                  , _react2.default.createElement(CustomDropdown, {
                    value: agentName,
                    onChange: (value) => {
                      setAgentName(value);
                      setSelectedKey(''); // Reset key when agent changes
                    },
                    options: [
                      { value: '', label: 'Select an agent' },
                      ...Object.keys(hubConfig.agents).map(name => ({
                        value: name,
                        label: name,
                        icon: _lucidereact.Users
                      }))
                    ],}
                  )
                )
                , agentName && (
                  _react2.default.createElement('div', null
                    , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Key"

                    )
                    , _react2.default.createElement(CustomDropdown, {
                      value: selectedKey,
                      onChange: setSelectedKey,
                      options: [
                        { value: '', label: 'Select a key' },
                        ...getAvailableKeys().map(key => ({
                          value: key,
                          label: key,
                          icon: _lucidereact.Key
                        }))
                      ],}
                    )
                    , getAvailableKeys().length === 0 && (
                      _react2.default.createElement('p', { className: "text-xs text-amber-600 mt-1"  ,}, "Selected agent has no output keys defined"     )
                    )
                  )
                )
                , _react2.default.createElement('div', null
                  , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Plan (JSON)"

                  )
                  , _react2.default.createElement('textarea', {
                    value: plan,
                    onChange: (e) => setPlan(e.target.value),
                    className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-24 font-mono text-sm"          ,
                    placeholder: "{\"vars\": {\"key\": \"value\"}}"  ,}
                  )
                  , _react2.default.createElement('p', { className: "text-xs text-gray-500 mt-1"  ,}, "Enter JSON configuration for the agent"     )
                )
              )
            )
          )

          , _react2.default.createElement('div', { className: "flex space-x-3 mt-6"  ,}
            , _react2.default.createElement('button', {
              onClick: handleClose,
              className: "flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"       ,}
, "Cancel"

            )
            , _react2.default.createElement('button', {
              onClick: handleSave,
              className: "flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors"       ,}

              , variableModalType === 'add' ? 'Add Variable' : 'Update Variable'
            )
          )
        )
      )
    );
  };

  // Agent Modal Component
  const AgentModal = () => {
    const [agentName, setAgentName] = _react.useState.call(void 0, '');
    const [template, setTemplate] = _react.useState.call(void 0, '');
    const [url, setUrl] = _react.useState.call(void 0, '');
    const [outputType, setOutputType] = _react.useState.call(void 0, 'json');
    
    _react.useEffect.call(void 0, () => {
      if (agentModalType === 'edit' && editingAgent) {
        setAgentName(editingAgent);
        setTemplate(_optionalChain([hubConfig, 'access', _ => _.agents, 'access', _2 => _2[editingAgent], 'optionalAccess', _3 => _3.template]) || '');
        setUrl(_optionalChain([hubConfig, 'access', _4 => _4.agents, 'access', _5 => _5[editingAgent], 'optionalAccess', _6 => _6.executor, 'optionalAccess', _7 => _7.url]) || '');
        setOutputType(_optionalChain([hubConfig, 'access', _8 => _8.agents, 'access', _9 => _9[editingAgent], 'optionalAccess', _10 => _10.output, 'optionalAccess', _11 => _11.type]) || 'json');
      } else {
        setAgentName('');
        setTemplate('[[PROMPT]]');
        setUrl('');
        setOutputType('json');
      }
    }, [agentModalType, editingAgent]);

    const handleSave = () => {
      if (!agentName.trim()) {
        alert('Please enter an agent name');
        return;
      }

      const newConfig = { ...hubConfig };
      
      if (agentModalType === 'add' && hubConfig.agents[agentName]) {
        alert('Agent name already exists');
        return;
      }

      if (agentModalType === 'edit' && editingAgent && agentName !== editingAgent) {
        // Rename agent
        delete newConfig.agents[editingAgent];
      }

      newConfig.agents[agentName] = {
        template: template || '[[PROMPT]]',
        executor: {
          type: "api",
          url: url || null,
          headers: { "Content-Type": "application/json" },
          data: {}
        },
        output: {
          type: outputType,
          keys: {
            "content": {
              "type": "string",
              "description": "Main content output"
            },
            "status": {
              "type": "int",
              "description": "Status code"
            }
          }
        },
        vars: {
          prompt: {
            type: "text",
            default: "Hello world."
          }
        }
      };

      setHubConfig(newConfig);
      setSelectedAgent(agentName);
      setShowAgentModal(false);
      setEditingAgent(null);
      setSelectedExample(''); // Clear example selection when manually editing
    };

    const handleClose = () => {
      setShowAgentModal(false);
      setEditingAgent(null);
    };

    return (
      _react2.default.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"       ,}
        , _react2.default.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4"      ,}
          , _react2.default.createElement('div', { className: "flex items-center justify-between mb-6"   ,}
            , _react2.default.createElement('h2', { className: "text-xl font-bold text-gray-900"  ,}
              , agentModalType === 'add' ? 'Add New Agent' : 'Edit Agent'
            )
            , _react2.default.createElement('button', {
              onClick: handleClose,
              className: "p-2 hover:bg-gray-100 rounded-lg transition-colors"   ,}

              , _react2.default.createElement(_lucidereact.X, { className: "w-5 h-5 text-gray-500"  ,} )
            )
          )

          , _react2.default.createElement('div', { className: "space-y-4",}
            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Agent Name"

              )
              , _react2.default.createElement('input', {
                type: "text",
                value: agentName,
                onChange: (e) => setAgentName(e.target.value),
                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
                placeholder: "Enter agent name"  ,
                autoFocus: true,}
              )
            )

            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Template"

              )
              , _react2.default.createElement('textarea', {
                value: template,
                onChange: (e) => setTemplate(e.target.value),
                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-24 font-mono text-sm"          ,
                placeholder: "Enter template with variables like [[VARIABLE_NAME]]"     ,}
              )
              , _react2.default.createElement('p', { className: "text-xs text-gray-500 mt-1"  ,}, "Use [[VARIABLE_NAME]] format for variables"    )
            )

            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Output Type")
              , _react2.default.createElement(CustomDropdown, {
                value: outputType,
                onChange: setOutputType,
                options: [
                  { value: 'json', label: 'JSON', icon: _lucidereact.Braces },
                  { value: 'raw', label: 'Raw', icon: _lucidereact.FileText },
                ],}
              )
            )

            , _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "API URL"

              )
              , _react2.default.createElement('input', {
                type: "text",
                value: url,
                onChange: (e) => setUrl(e.target.value),
                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
                placeholder: "https://api.example.com/endpoint",}
              )
            )
          )

          , _react2.default.createElement('div', { className: "flex space-x-3 mt-6"  ,}
            , _react2.default.createElement('button', {
              onClick: handleClose,
              className: "flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"       ,}
, "Cancel"

            )
            , _react2.default.createElement('button', {
              onClick: handleSave,
              className: "flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors"       ,}

              , agentModalType === 'add' ? 'Create Agent' : 'Update Agent'
            )
          )
        )
      )
    );
  };

  const addAgent = () => {
    setAgentModalType('add');
    setShowAgentModal(true);
  };

  const editAgent = (agentName) => {
    setAgentModalType('edit');
    setEditingAgent(agentName);
    setShowAgentModal(true);
  };

  const deleteAgent = (agentName) => {
    if (confirm(`Are you sure you want to delete agent "${agentName}"? This action cannot be undone.`)) {
      const newConfig = { ...hubConfig };
      delete newConfig.agents[agentName];
      setHubConfig(newConfig);
      if (selectedAgent === agentName) {
        const remainingAgents = Object.keys(newConfig.agents);
        setSelectedAgent(remainingAgents[0] || null);
      }
      setSelectedExample(''); // Clear example selection when manually editing
    }
  };

  const updateAgent = (path, value) => {
    const pathArray = path.split('.');
    const newConfig = JSON.parse(JSON.stringify(hubConfig));
    let current = newConfig.agents[selectedAgent];
    
    for (let i = 0; i < pathArray.length - 1; i++) {
      current = current[pathArray[i]];
    }
    current[pathArray[pathArray.length - 1]] = value;
    
    setHubConfig(newConfig);
    setSelectedExample(''); // Clear example selection when manually editing
  };

  const addVariable = () => {
    setVariableModalType('add');
    setShowVariableModal(true);
  };

  const editVariable = (varName) => {
    setVariableModalType('edit');
    setEditingVariable(varName);
    setShowVariableModal(true);
  };

  const removeVariable = (varName) => {
    if (confirm(`Are you sure you want to delete variable "${varName}"? This action cannot be undone.`)) {
      const newVars = { ...currentAgent.vars };
      delete newVars[varName];
      updateAgent('vars', newVars);
    }
  };

  const addOutputKey = () => {
    setOutputKeyModalType('add');
    setShowOutputKeyModal(true);
  };

  const editOutputKey = (keyName) => {
    setOutputKeyModalType('edit');
    setEditingOutputKey(keyName);
    setShowOutputKeyModal(true);
  };

  const removeOutputKey = (keyName) => {
    if (confirm(`Are you sure you want to delete output key "${keyName}"? This action cannot be undone.`)) {
      const newOutput = { ...currentAgent.output };
      const newKeys = { ...newOutput.keys };
      delete newKeys[keyName];
      newOutput.keys = newKeys;
      updateAgent('output', newOutput);
    }
  };

  const handleFieldClick = (fieldPath, fieldData) => {
    setSelectedField({ path: fieldPath, data: fieldData, agentName: selectedAgent });
    setRightPanelView('field');
  };

  const jumpToAgent = (agentName) => {
    if (hubConfig.agents[agentName]) {
      setSelectedAgent(agentName);
      setSelectedField(null);
      setRightPanelView('field');
    }
  };

  const exportHubConfig = () => {
    const dataStr = JSON.stringify(hubConfig, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
    const exportFileDefaultName = 'pandex_hub_config.json';
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    linkElement.click();
  };

  const importHubConfig = (event) => {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const importedConfig = JSON.parse(e.target.result);
          setHubConfig(importedConfig);
          const firstAgent = Object.keys(importedConfig.agents)[0];
          if (firstAgent) {
            setSelectedAgent(firstAgent);
          }
          setSelectedField(null);
          setRightPanelView('field');
          setSelectedExample(''); // Clear example selection when importing
        } catch (error) {
          alert('Invalid JSON file');
        }
      };
      reader.readAsText(file);
    }
    event.target.value = '';
  };

  const exportAgentConfig = () => {
    if (!selectedAgent || !currentAgent) return;
    const dataStr = JSON.stringify(currentAgent, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
    const exportFileDefaultName = `${selectedAgent}_config.json`;
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    linkElement.click();
  };

  const importAgentConfig = (event) => {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const importedAgent = JSON.parse(e.target.result);
          const agentName = prompt('Enter name for imported agent:', file.name.replace('.json', ''));
          if (agentName) {
            const newConfig = { ...hubConfig };
            newConfig.agents[agentName] = importedAgent;
            setHubConfig(newConfig);
            setSelectedAgent(agentName);
            setSelectedField(null);
            setRightPanelView('field');
            setSelectedExample(''); // Clear example selection when importing
          }
        } catch (error) {
          alert('Invalid JSON file');
        }
      };
      reader.readAsText(file);
    }
    event.target.value = '';
  };

  const generateConfiguration = async () => {
    if (!generatePrompt.trim()) {
      alert('Please enter a description for generation');
      return;
    }

    setIsGenerating(true);

    try {
      // Create a detailed prompt for Pollinations AI
      let aiPrompt;
      
      if (generateType === 'hub') {
        aiPrompt = `Create a JSON configuration for a Pandex Agent Hub based on this description: "${generatePrompt}". 

The JSON should have this structure:
{
  "agents": {
    "agent_name": {
      "template": "Template text with [[VARIABLE_NAME]] placeholders",
      "executor": {
        "type": "api",
        "url": "https://api.example.com/endpoint",
        "headers": {"Content-Type": "application/json"},
        "data": {}
      },
      "output": {
        "type": "json",
        "keys": {
          "key_name": {
            "type": "string|int|bool|array|object",
            "description": "description of the key"
          }
        }
      },
      "vars": {
        "variable_name": {
          "type": "text",
          "default": "default value"
        }
      }
    }
  }
}

Create multiple agents that work together for the described purpose. Use meaningful agent names and templates. Include variables with [[VARIABLE_NAME]] format in templates.`;
      } else {
        aiPrompt = `Create a JSON configuration for a single Pandex Agent based on this description: "${generatePrompt}".

The JSON should have this structure:
{
  "template": "Template text with [[VARIABLE_NAME]] placeholders describing what the agent does",
  "executor": {
    "type": "api", 
    "url": "https://api.example.com/endpoint",
    "headers": {"Content-Type": "application/json"},
    "data": {}
  },
  "output": {
    "type": "json",
    "keys": {
      "key_name": {
        "type": "string|int|bool|array|object",
        "description": "description of the key"
      }
    }
  },
  "vars": {
    "variable_name": {
      "type": "text",
      "default": "default value"
    }
  }
}

Create an agent that performs the described task. Use meaningful variable names and include them in the template with [[VARIABLE_NAME]] format.`;
      }

      console.log('Sending prompt to Pollinations AI:', aiPrompt);

      const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(aiPrompt)}`);
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const textResponse = await response.text();
      console.log('Pollinations AI response:', textResponse);
      
      if (generateType === 'hub') {
        const hubResult = createHubFromResponse(textResponse, generatePrompt);
        setHubConfig(hubResult);
        const firstAgent = Object.keys(hubResult.agents)[0];
        if (firstAgent) {
          setSelectedAgent(firstAgent);
        }
        setSelectedField(null);
        setRightPanelView('field');
        setSelectedExample(''); // Clear example selection when generating
      } else {
        // Generate single agent
        const agentResult = createAgentFromResponse(textResponse, generatePrompt);
        const agentName = prompt('Enter name for generated agent:', 'ai_generated_agent') || 'ai_generated_agent';
        
        const newConfig = { ...hubConfig };
        newConfig.agents[agentName] = agentResult;
        setHubConfig(newConfig);
        setSelectedAgent(agentName);
        setSelectedField(null);
        setRightPanelView('field');
        setSelectedExample(''); // Clear example selection when generating
      }

      setGeneratePrompt('');
      
    } catch (error) {
      console.error('Generation error:', error);
      
      // Fallback: create a basic structure if AI fails
      if (generateType === 'hub') {
        const fallbackHub = {
          agents: {
            [`fallback_agent_${Date.now()}`]: {
              template: `Agent for: "${generatePrompt}". Process [[INPUT]] and return result.`,
              executor: {
                type: "api",
                url: "https://api.example.com/generated",
                headers: { "Content-Type": "application/json" },
                data: { prompt: generatePrompt }
              },
              output: {
                type: "json",
                keys: {
                  "output": {
                    "type": "string",
                    "description": "Main output"
                  },
                  "status": {
                    "type": "int",
                    "description": "Status code"
                  }
                }
              },
              vars: {
                input: {
                  type: "text",
                  default: "Enter input here"
                }
              }
            }
          }
        };
        setHubConfig(fallbackHub);
        setSelectedAgent(Object.keys(fallbackHub.agents)[0]);
      } else {
        // Generate single agent fallback
        const agentName = prompt('Enter name for generated agent:', 'generated_agent') || 'generated_agent';
        const fallbackAgent = {
          template: `Agent for: "${generatePrompt}". Process [[INPUT]] and provide result.`,
          executor: {
            type: "api",
            url: "https://api.example.com/generated",
            headers: { "Content-Type": "application/json" },
            data: { purpose: generatePrompt }
          },
          output: {
            type: "json",
            keys: {
              "output": {
                "type": "string",
                "description": "Main output"
              },
              "status": {
                "type": "int",
                "description": "Status code"
              }
            }
          },
          vars: {
            input: {
              type: "text",
              default: "user input"
            }
          }
        };

        const newConfig = { ...hubConfig };
        newConfig.agents[agentName] = fallbackAgent;
        setHubConfig(newConfig);
        setSelectedAgent(agentName);
      }

      setSelectedField(null);
      setRightPanelView('field');
      setGeneratePrompt('');
      setSelectedExample(''); // Clear example selection when generating
      
      alert('AI generation encountered an issue, but created a basic structure. You can edit it manually.');
    } finally {
      setIsGenerating(false);
    }
  };

  const openGithubRepo = () => {
    window.open('https://github.com/aeromechanic000/pandex-agent', '_blank');
  };

  // Poll hub status
  const pollHubStatus = async (hubId) => {
    try {
      const response = await fetch(`http://localhost:3333/api/hub/${hubId}/status`);
      const result = await response.json();
      
      if (response.ok) {
        setExecutionStatus(result);
        
        // If execution is finished, stop polling
        if (result.hub_status === 'finished' || result.hub_status === 'error') {
          if (statusPolling) {
            clearInterval(statusPolling);
            setStatusPolling(null);
          }
          setExecutionResult({
            status: result.hub_status,
            timestamp: new Date().toISOString(),
            agent: result.executed_agent,
            hub_id: hubId,
            result: result.agent_result || result,
            execution_time: result.execution_time,
            error: result.error
          });
          setRightPanelView('execution');
          setIsExecuting(false);
        }
      }
    } catch (error) {
      console.error('Error polling status:', error);
    }
  };

  const executeAgent = async () => {
    if (!selectedAgent || !currentAgent) return;
    
    setIsExecuting(true);
    setExecutionResult(null);
    setExecutionStatus(null);
    
    // Clear any existing polling
    if (statusPolling) {
      clearInterval(statusPolling);
      setStatusPolling(null);
    }
    
    try {
      const response = await fetch('http://localhost:3333/api/hub/execute', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          configHub: hubConfig,  // Changed from hub_config to configHub
          agentName: selectedAgent,  // Changed from agent_name to agentName
          plan: {
            vars: {} // You can add plan parameters here if needed
          }
        })
      });
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const result = await response.json();
      
      if (result.status === 'success') {
        // Handle successful execution
        setExecutionResult({
          status: 'success',
          timestamp: new Date().toISOString(),
          agent: selectedAgent,
          result: result.result,
          hub_status: result.hub_status
        });
        setRightPanelView('execution');
        setIsExecuting(false);
      } else {
        throw new Error(result.message || 'Unknown error');
      }
      
    } catch (error) {
      console.error('Execution error:', error);
      
      // Show error result
      setExecutionResult({
        status: 'error',
        timestamp: new Date().toISOString(),
        agent: selectedAgent,
        result: null,
        error: error.message
      });
      setIsExecuting(false);
      setRightPanelView('execution');
    }
  };

  // Cleanup polling on unmount
  _react.useEffect.call(void 0, () => {
    return () => {
      if (statusPolling) {
        clearInterval(statusPolling);
      }
    };
  }, [statusPolling]);

  const getFieldIcon = (fieldType) => {
    switch (fieldType) {
      case 'template': return _react2.default.createElement(_lucidereact.Code, { className: "w-4 h-4" ,} );
      case 'executor': return _react2.default.createElement(_lucidereact.Zap, { className: "w-4 h-4" ,} );
      case 'output': return _react2.default.createElement(_lucidereact.FileOutput, { className: "w-4 h-4" ,} );
      case 'vars': return _react2.default.createElement(_lucidereact.Database, { className: "w-4 h-4" ,} );
      default: return _react2.default.createElement(_lucidereact.Settings, { className: "w-4 h-4" ,} );
    }
  };

  // Custom Dropdown Component
  const CustomDropdown = ({ value, onChange, options, className = "" }) => {
    const [isOpen, setIsOpen] = _react.useState.call(void 0, false);
    
    return (
      _react2.default.createElement('div', { className: `relative ${className}`,}
        , _react2.default.createElement('button', {
          onClick: () => setIsOpen(!isOpen),
          className: "w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-left focus:ring-2 focus:ring-purple-500 focus:border-transparent hover:border-gray-400 transition-colors flex items-center justify-between"                ,}

          , _react2.default.createElement('span', { className: "capitalize font-medium" ,}, value)
          , _react2.default.createElement(_lucidereact.ChevronDown, { className: `w-4 h-4 text-gray-500 transition-transform ${isOpen ? 'rotate-180' : ''}`,} )
        )

        , isOpen && (
          _react2.default.createElement(_react2.default.Fragment, null
            , _react2.default.createElement('div', { 
              className: "fixed inset-0 z-10"  , 
              onClick: () => setIsOpen(false),}
            )
            , _react2.default.createElement('div', { className: "absolute top-full mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg z-20 overflow-hidden"          ,}
              , options.map((option) => (
                _react2.default.createElement('button', {
                  key: option.value,
                  onClick: () => {
                    onChange(option.value);
                    setIsOpen(false);
                  },
                  className: `w-full px-3 py-2 text-sm text-left hover:bg-gray-50 transition-colors flex items-center space-x-2 ${
                    value === option.value ? 'bg-purple-50 text-purple-700' : 'text-gray-700'
                  }`,}

                  , option.icon && _react2.default.createElement(option.icon, { className: "w-4 h-4" ,} )
                  , _react2.default.createElement('span', { className: "capitalize",}, option.label)
                )
              ))
            )
          )
        )
      )
    );
  };

  const FieldEditor = ({ fieldPath, fieldData, onUpdate, agentName }) => {
    const [localData, setLocalData] = _react.useState.call(void 0, fieldData);
    const [isUpdating, setIsUpdating] = _react.useState.call(void 0, false);

    // Only update local state when fieldData changes and we're not currently updating
    _react.useEffect.call(void 0, () => {
      if (!isUpdating) {
        setLocalData(fieldData);
      }
    }, [fieldData, isUpdating]);

    const handleUpdate = (key, value) => {
      const updated = { ...localData, [key]: value };
      setLocalData(updated);
      setIsUpdating(true);
      
      // Use setTimeout to ensure the update happens after the current render cycle
      setTimeout(() => {
        onUpdate(fieldPath, updated);
        setIsUpdating(false);
      }, 0);

      setTimeout(() => {
        handleFieldClick(fieldPath, updated)
      }, 5);
    };

    const handleDirectUpdate = (newValue) => {
      setLocalData(newValue);
      setIsUpdating(true);
      
      // Use setTimeout to ensure the update happens after the current render cycle
      setTimeout(() => {
        onUpdate(fieldPath, newValue);
        setIsUpdating(false);
      }, 0);

      setTimeout(() => {
        handleFieldClick(fieldPath, newValue)
      }, 5);
    };

    if (fieldPath === 'template') {
      return (
        _react2.default.createElement('div', { className: "space-y-4",}
          , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700"   ,}, "Template")
          , _react2.default.createElement('textarea', {
            value: localData || '',
            onChange: (e) => {
              const newValue = e.target.value;
              setLocalData(newValue);
            },
            onBlur: (e) => {
              const newValue = e.target.value;
              handleDirectUpdate(newValue);
              setTimeout(() => {
                handleFieldClick('template', currentAgent.template)
              }, 0);
            },
            className: "w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm"          ,
            placeholder: "Enter template with variables like [[VARIABLE_NAME]]"     ,}
          )
          , _react2.default.createElement('p', { className: "text-xs text-gray-500" ,}, "Use [[VARIABLE_NAME]] format for variables"    )
        )
      );
    }

    if (fieldPath === 'output') {
      return (
        _react2.default.createElement('div', { className: "space-y-4",}
          , _react2.default.createElement('div', null
            , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Output Type")
            , _react2.default.createElement(CustomDropdown, {
              value: localData.type || 'json',
              onChange: (value) => handleUpdate('type', value),
              options: [
                { value: 'json', label: 'JSON', icon: _lucidereact.Braces },
                { value: 'raw', label: 'Raw', icon: _lucidereact.FileText },
              ],}
            )
          )
          , _react2.default.createElement('div', null
            , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Output Keys")
            , _react2.default.createElement('div', { className: "space-y-2",}
              , Object.entries(localData.keys || {}).map(([keyName, keyConfig]) => (
                _react2.default.createElement('div', { key: keyName, className: "flex items-center justify-between p-2 bg-gray-50 rounded border"     ,}
                  , _react2.default.createElement('div', { className: "flex-1",}
                    , _react2.default.createElement('span', { className: "font-medium text-sm" ,}, keyName)
                    , _react2.default.createElement('span', { className: `ml-2 px-2 py-0.5 text-xs rounded-full ${
                      keyConfig.type === 'string' ? 'bg-green-100 text-green-800' :
                      keyConfig.type === 'int' ? 'bg-blue-100 text-blue-800' :
                      keyConfig.type === 'bool' ? 'bg-purple-100 text-purple-800' :
                      'bg-gray-100 text-gray-800'
                    }`,}
                      , keyConfig.type
                    )
                    , keyConfig.description && (
                      _react2.default.createElement('p', { className: "text-xs text-gray-500 mt-1"  ,}, keyConfig.description)
                    )
                  )
                  , mode === 'edit' && (
                    _react2.default.createElement('div', { className: "flex items-center space-x-1"  ,}
                      , _react2.default.createElement('button', {
                        onClick: () => editOutputKey(keyName),
                        className: "p-1 text-blue-500 hover:bg-blue-100 rounded"   ,
                        title: "Edit key" ,}

                        , _react2.default.createElement(_lucidereact.Edit3, { className: "w-3 h-3" ,} )
                      )
                      , _react2.default.createElement('button', {
                        onClick: () => removeOutputKey(keyName),
                        className: "p-1 text-red-500 hover:bg-red-100 rounded"   ,
                        title: "Delete key" ,}

                        , _react2.default.createElement(_lucidereact.Trash2, { className: "w-3 h-3" ,} )
                      )
                    )
                  )
                )
              ))
              , mode === 'edit' && (
                _react2.default.createElement('button', {
                  onClick: addOutputKey,
                  className: "w-full p-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-blue-300 hover:text-blue-500 transition-colors"        ,}

                  , _react2.default.createElement(_lucidereact.Plus, { className: "w-4 h-4 inline mr-2" ,} )
                  , "Add Output Key"
                )
              )
            )
          )
        )
      );
    }

    if (fieldPath === 'executor') {
      return (
        _react2.default.createElement('div', { className: "space-y-4",}
          , _react2.default.createElement('div', null
            , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Type")
            , _react2.default.createElement(CustomDropdown, {
              value: localData.type || 'api',
              onChange: (value) => handleUpdate('type', value),
              options: [
                { value: 'api', label: 'API', icon: _lucidereact.Zap }
              ],}
            )
          )
          , _react2.default.createElement('div', null
            , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "URL")
            , _react2.default.createElement('input', {
              type: "text",
              value: localData.url || '',
              onChange: (e) => handleUpdate('url', e.target.value),
              className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
              placeholder: "https://api.example.com/endpoint",}
            )
          )
          , _react2.default.createElement('div', null
            , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Headers (JSON)" )
            , _react2.default.createElement('textarea', {
              value: JSON.stringify(localData.headers || {}, null, 2),
              onChange: (e) => {
                try {
                  handleUpdate('headers', JSON.parse(e.target.value));
                } catch (err) {
                  // Invalid JSON, don't update
                }
              },
              className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 font-mono text-sm"          ,
              placeholder: "{\"Content-Type\": \"application/json\"}" ,}
            )
          )
          , _react2.default.createElement('div', null
            , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Data (JSON)" )
            , _react2.default.createElement('textarea', {
              value: JSON.stringify(localData.data || {}, null, 2),
              onChange: (e) => {
                try {
                  handleUpdate('data', JSON.parse(e.target.value));
                } catch (err) {
                  // Invalid JSON, don't update
                }
              },
              className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-20 font-mono text-sm"          ,
              placeholder: "{\"key\": \"value\"}" ,}
            )
          )
        )
      );
    }

    if (fieldPath.startsWith('vars.')) {
      const varTypes = [
        { value: 'text', label: 'Text', icon: _lucidereact.FileText },
        { value: 'agent', label: 'Agent', icon: _lucidereact.Users }
      ];
      
      // Get available keys from selected agent
      const getAvailableKeys = () => {
        if (!localData.agent || !hubConfig.agents[localData.agent]) {
          return [];
        }
        return Object.keys(hubConfig.agents[localData.agent].output?.keys || {});
      };
      
      return (
        _react2.default.createElement('div', { className: "space-y-4",}
          , _react2.default.createElement('div', null
            , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Type")
            , _react2.default.createElement(CustomDropdown, {
              value: localData.type || 'text',
              onChange: (value) => handleUpdate('type', value),
              options: varTypes,}
            )
          )

          , localData.type === 'text' && (
            _react2.default.createElement('div', null
              , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Default Value" )
              , _react2.default.createElement('input', {
                type: "text",
                value: localData.default || '',
                onChange: (e) => handleUpdate('default', e.target.value),
                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"       ,
                placeholder: "Enter default value"  ,}
              )
            )
          )

          , localData.type === 'agent' && (
            _react2.default.createElement(_react2.default.Fragment, null
              , _react2.default.createElement('div', null
                , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Agent Name" )
                , _react2.default.createElement('div', { className: "flex space-x-2" ,}
                  , _react2.default.createElement(CustomDropdown, {
                    value: localData.agent || '',
                    onChange: (value) => {
                      handleUpdate('agent', value);
                      // Reset key when agent changes
                      if (localData.key) {
                        handleUpdate('key', '');
                      }
                    },
                    options: [
                      { value: '', label: 'Select an agent' },
                      ...Object.keys(hubConfig.agents).map(name => ({
                        value: name,
                        label: name,
                        icon: _lucidereact.Users
                      }))
                    ],
                    className: "flex-1",}
                  )
                  , localData.agent && hubConfig.agents[localData.agent] && (
                    _react2.default.createElement('button', {
                      onClick: () => jumpToAgent(localData.agent),
                      className: "px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-1"         ,
                      title: "Jump to agent"  ,}

                      , _react2.default.createElement(_lucidereact.ExternalLink, { className: "w-4 h-4" ,} )
                    )
                  )
                )
              )
              , localData.agent && (
                _react2.default.createElement('div', null
                  , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Key"

                  )
                  , _react2.default.createElement(CustomDropdown, {
                    value: localData.key || '',
                    onChange: (value) => handleUpdate('key', value),
                    options: [
                      { value: '', label: 'Select a key' },
                      ...getAvailableKeys().map(key => ({
                        value: key,
                        label: key,
                        icon: _lucidereact.Key
                      }))
                    ],}
                  )
                  , getAvailableKeys().length === 0 && (
                    _react2.default.createElement('p', { className: "text-xs text-amber-600 mt-1"  ,}, "Selected agent has no output keys defined"     )
                  )
                )
              )
              , _react2.default.createElement('div', null
                , _react2.default.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2"    ,}, "Plan (JSON)" )
                , _react2.default.createElement('textarea', {
                  value: JSON.stringify(localData.plan || {}, null, 2),
                  onChange: (e) => {
                    try {
                      handleUpdate('plan', JSON.parse(e.target.value));
                    } catch (err) {
                      // Invalid JSON, don't update
                    }
                  },
                  className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent h-24 font-mono text-sm"          ,
                  placeholder: "{\"vars\": {\"key\": \"value\"}}"  ,}
                )
              )
            )
          )
        )
      );
    }

    return null;
  };

  const getRightPanelTitle = () => {
    switch (rightPanelView) {
      case 'execution': return 'Execution Status';
      case 'json': return 'Agent JSON';
      default: return 'Field Details';
    }
  };

  const renderRightPanelContent = () => {
    switch (rightPanelView) {
      case 'execution':
        return (executionResult || executionStatus) ? (
          _react2.default.createElement('div', { className: "space-y-4",}
            , _react2.default.createElement('div', { className: "flex items-center justify-between"  ,}
              , _react2.default.createElement('h3', { className: "text-sm font-semibold text-gray-900"  ,}, "Execution Status" )
              , _react2.default.createElement('button', {
                onClick: () => setRightPanelView('field'),
                className: "text-sm text-gray-500 hover:text-gray-700"  ,}
, " Close"

              )
            )

            , executionStatus && !executionResult && (
              _react2.default.createElement('div', { className: "p-4 rounded-lg border bg-blue-50 border-blue-200"     ,}
                , _react2.default.createElement('div', { className: "space-y-2",}
                  , _react2.default.createElement('div', null
                    , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Hub ID:")
                    , _react2.default.createElement('p', { className: "text-sm text-gray-900" ,}, executionStatus.hub_id)
                  )
                  , _react2.default.createElement('div', null
                    , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Status:")
                    , _react2.default.createElement('p', { className: "text-sm text-gray-900 flex items-center space-x-2"    ,}
                      , _react2.default.createElement('span', null, executionStatus.hub_status)
                      , executionStatus.hub_status === 'executing' && (
                        _react2.default.createElement(_lucidereact.Loader, { className: "w-4 h-4 animate-spin text-blue-600"  ,} )
                      )
                    )
                  )
                  , executionStatus.message && (
                    _react2.default.createElement('div', null
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Message:")
                      , _react2.default.createElement('p', { className: "text-sm text-gray-900" ,}, executionStatus.message)
                    )
                  )
                )
              )
            )

            , executionResult && (
              _react2.default.createElement('div', { className: `p-4 rounded-lg border ${
                executionResult.status === 'success' || executionResult.status === 'finished' ? 'bg-green-50 border-green-200' :
                executionResult.status === 'simulated' ? 'bg-blue-50 border-blue-200' :
                'bg-red-50 border-red-200'
              }`,}
                , _react2.default.createElement('div', { className: "space-y-2",}
                  , _react2.default.createElement('div', null
                    , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Status:")
                    , _react2.default.createElement('p', { className: "text-sm text-gray-900" ,}, executionResult.status)
                  )
                  , _react2.default.createElement('div', null
                    , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Agent:")
                    , _react2.default.createElement('p', { className: "text-sm text-gray-900" ,}, executionResult.agent)
                  )
                  , executionResult.hub_id && (
                    _react2.default.createElement('div', null
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Hub ID:")
                      , _react2.default.createElement('p', { className: "text-sm text-gray-900 font-mono text-xs"  ,}, executionResult.hub_id)
                    )
                  )
                  , _react2.default.createElement('div', null
                    , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Timestamp:")
                    , _react2.default.createElement('p', { className: "text-sm text-gray-900" ,}, new Date(executionResult.timestamp).toLocaleString())
                  )
                  , executionResult.execution_time && (
                    _react2.default.createElement('div', null
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Execution Time:")
                      , _react2.default.createElement('p', { className: "text-sm text-gray-900" ,}, `${executionResult.execution_time.toFixed(2)}s`)
                    )
                  )
                  , executionResult.error && (
                    _react2.default.createElement('div', null
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Note:")
                      , _react2.default.createElement('p', { className: "text-sm text-gray-600" ,}, typeof executionResult.error === 'string' ? executionResult.error : JSON.stringify(executionResult.error))
                    )
                  )
                )
              )
            )

            , executionResult && executionResult.result && (
              _react2.default.createElement('div', null
                , _react2.default.createElement('h4', { className: "text-sm font-semibold text-gray-900 mb-2"   ,}, "Result Details" )
                , _react2.default.createElement('pre', { className: "text-xs bg-gray-50 p-3 rounded border overflow-auto max-h-96 font-mono"       ,}
                  , JSON.stringify(executionResult.result, null, 2)
                )
              )
            )
          )
        ) : (
          _react2.default.createElement('p', { className: "text-gray-500",}, "No execution result available."   )
        );

      case 'json':
        return (
          _react2.default.createElement('div', { className: "space-y-4",}
            , _react2.default.createElement('div', { className: "flex items-center justify-between"  ,}
              , _react2.default.createElement('h3', { className: "text-sm font-semibold text-gray-900"  ,}, "Agent Configuration" )
              , _react2.default.createElement('button', {
                onClick: () => setRightPanelView('field'),
                className: "text-sm text-gray-500 hover:text-gray-700"  ,}
, " Close"

              )
            )
            , _react2.default.createElement('pre', { className: "text-xs bg-gray-50 p-3 rounded border overflow-auto font-mono"      ,}
              , selectedAgent ? JSON.stringify(currentAgent, null, 2) : 'No agent selected'
            )
          )
        );

      default:
        return selectedField ? (
          _react2.default.createElement('div', null
            , _react2.default.createElement('div', { className: "mb-4",}
              , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Agent:")
              , _react2.default.createElement('p', { className: "text-lg font-medium text-gray-900"  ,}, selectedField.agentName)
            )
            , _react2.default.createElement('div', { className: "mb-4",}
              , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Field:")
              , _react2.default.createElement('p', { className: "text-lg font-medium text-gray-900"  ,}, selectedField.path)
            )

            , mode === 'edit' ? (
              _react2.default.createElement(FieldEditor, {
                fieldPath: selectedField.path,
                fieldData: selectedField.data,
                agentName: selectedField.agentName,
                onUpdate: updateAgent,}
              )
            ) : (
              _react2.default.createElement('div', { className: "space-y-3",}
                , _react2.default.createElement('div', null
                  , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Value:")
                  , _react2.default.createElement('pre', { className: "text-sm bg-gray-50 p-3 rounded mt-1 border font-mono"      ,}
                    , JSON.stringify(selectedField.data, null, 2)
                  )
                )
              )
            )
          )
        ) : (
          _react2.default.createElement('p', { className: "text-gray-500",}, "Click on a field to view and edit its details."         )
        );
    }
  };

  // Filter agents based on search
  const filteredAgents = Object.keys(hubConfig.agents).filter(agentName =>
    agentName.toLowerCase().includes(agentSearch.toLowerCase())
  );

  return (
    _react2.default.createElement('div', { className: "min-h-screen bg-gray-100" ,}
      /* Agent Modal */
      , showAgentModal && _react2.default.createElement(AgentModal, null )

      /* Variable Modal */
      , showVariableModal && _react2.default.createElement(VariableModal, null )

      /* Output Key Modal */
      , showOutputKeyModal && _react2.default.createElement(OutputKeyModal, null )

      /* Title Bar */
      , _react2.default.createElement('div', { className: "bg-white border-b border-gray-200 px-6 py-4"    ,}
        , _react2.default.createElement('div', { className: "flex items-center justify-between w-full"   ,}
          /* Left: Title */
          , _react2.default.createElement('div', { className: "flex items-center space-x-3 flex-shrink-0"   ,}
            , _react2.default.createElement('img', { className: "w-8 h-8", src: "{{ url_for('static', filename='icon.png') }}", alt: "Pandex Agent"} )
            , _react2.default.createElement('h1', { className: "text-2xl font-bold text-gray-900 whitespace-nowrap"   ,}, "Pandex Agent Playground"    )
          )

          /* Center: Generation Section */
          , _react2.default.createElement('div', { className: "flex-1 max-w-6xl mx-6"  ,}
            , _react2.default.createElement('div', { className: "flex items-center space-x-3 bg-gradient-to-r from-purple-50 to-pink-50 px-4 py-3 rounded-lg border border-purple-200"        ,}
              , _react2.default.createElement(_lucidereact.Sparkles, { className: "w-5 h-5 text-purple-600 flex-shrink-0"  ,} )
              , _react2.default.createElement(CustomDropdown, {
                value: generateType,
                onChange: setGenerateType,
                options: [
                  { value: 'agent', label: 'Agent', icon: _lucidereact.Users },
                  { value: 'hub', label: 'Hub', icon: _lucidereact.Database }
                ],
                className: "w-24 flex-shrink-0",}
              )
              , _react2.default.createElement('input', {
                type: "text",
                value: generatePrompt,
                onChange: (e) => setGeneratePrompt(e.target.value),
                placeholder: `Describe the ${generateType} to generate...`,
                className: "flex-1 min-w-96 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"         ,
                onKeyPress: (e) => e.key === 'Enter' && generateConfiguration(),}
              )
              , _react2.default.createElement('button', {
                onClick: generateConfiguration,
                disabled: !generatePrompt.trim() || isGenerating,
                className: "flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm flex-shrink-0"            ,}

                , _react2.default.createElement(_lucidereact.Sparkles, { className: `w-4 h-4 ${isGenerating ? 'animate-spin' : ''}`,} )
                , _react2.default.createElement('span', null, isGenerating ? 'Generating...' : 'Generate')
              )
            )
          )

          /* Right: Action Buttons */
          , _react2.default.createElement('div', { className: "flex items-center space-x-2 flex-shrink-0"   ,}
            /* Hub Import/Export */
            , _react2.default.createElement('label', { className: "flex items-center space-x-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors cursor-pointer text-sm"           ,}
              , _react2.default.createElement(_lucidereact.Upload, { className: "w-4 h-4" ,} )
              , _react2.default.createElement('span', { className: "hidden lg:inline",}, "Import")
              , _react2.default.createElement('input', {
                type: "file",
                accept: ".json",
                onChange: importHubConfig,
                className: "hidden",}
              )
            )
            , _react2.default.createElement('button', {
              onClick: exportHubConfig,
              className: "flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"          ,}

              , _react2.default.createElement(_lucidereact.Download, { className: "w-4 h-4" ,} )
              , _react2.default.createElement('span', { className: "hidden lg:inline",}, "Export")
            )
            , _react2.default.createElement('button', {
              onClick: () => setRightPanelView('json'),
              disabled: !selectedAgent,
              className: "flex items-center space-x-2 px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm"          ,}

              , _react2.default.createElement(_lucidereact.FileText, { className: "w-4 h-4" ,} )
              , _react2.default.createElement('span', { className: "hidden lg:inline",}, "JSON")
            )
            , _react2.default.createElement('button', {
              onClick: openGithubRepo,
              className: "flex items-center space-x-2 px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm"          ,}

              , _react2.default.createElement(_lucidereact.Github, { className: "w-4 h-4" ,} )
              , _react2.default.createElement('span', { className: "hidden lg:inline",}, "GitHub")
            )
          )
        )
      )

      , _react2.default.createElement('div', { className: "flex h-screen" ,}
        /* Left Sidebar - Agents */
        , _react2.default.createElement('div', { className: "w-80 bg-white border-r border-gray-200 flex flex-col"     ,}
          , _react2.default.createElement('div', { className: "p-4 border-b border-gray-200"  ,}
            
            /* Example Selector */
            , _react2.default.createElement('div', { className: "mb-3",}
              , _react2.default.createElement('div', { className: "relative",}
                , _react2.default.createElement(CustomDropdown, {
                  value: selectedExample || '',
                  onChange: (value) => {
                    if (value && value !== selectedExample) {
                      loadExample(value);
                    }
                  },
                  options: [
                    { value: '', label: 'Select an example...', icon: _lucidereact.FileText },
                    ...availableExamples.map(example => ({
                      value: example,
                      label: example === 'default' ? 'Default' : example,
                      icon: example === 'default' ? _lucidereact.Home : _lucidereact.Database
                    }))
                  ],
                  className: isLoadingExample ? 'opacity-50 pointer-events-none' : '',}
                )
                , isLoadingExample && (
                  _react2.default.createElement('div', { className: "absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"      ,}
                    , _react2.default.createElement(_lucidereact.Loader, { className: "w-4 h-4 animate-spin text-blue-600"  ,} )
                  )
                )
              )
              , selectedExample && (
                _react2.default.createElement('div', { className: "flex items-center space-x-2 mt-2 p-2 bg-green-50 border border-green-200 rounded-lg"       ,}
                  , _react2.default.createElement(_lucidereact.CheckCircle, { className: "w-4 h-4 text-green-600 flex-shrink-0"  ,} )
                  , _react2.default.createElement('span', { className: "text-sm text-green-700 font-medium"  ,}
                    , "Loaded: ", selectedExample === 'default' ? 'Default' : selectedExample
                  )
                  , _react2.default.createElement('button', {
                    onClick: () => {
                      setSelectedExample('');
                      // Optionally clear the current hub or reset to a blank state
                    },
                    className: "ml-auto p-1 text-green-600 hover:bg-green-100 rounded transition-colors"     ,
                    title: "Clear selection" ,}

                    , _react2.default.createElement(_lucidereact.X, { className: "w-3 h-3" ,} )
                  )
                )
              )
            )
            
            , _react2.default.createElement('div', { className: "flex items-center justify-between mb-3"   ,}
              , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                , _react2.default.createElement(_lucidereact.Users, { className: "w-5 h-5 text-blue-600"  ,} )
                , _react2.default.createElement('h2', { className: "text-lg font-semibold text-gray-900"  ,}, "Agents")
              )
              , _react2.default.createElement('button', {
                onClick: addAgent,
                className: "p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"     ,}

                , _react2.default.createElement(_lucidereact.Plus, { className: "w-4 h-4" ,} )
              )
            )
            /* Search */
            , _react2.default.createElement('div', { className: "relative",}
              , _react2.default.createElement(_lucidereact.Search, { className: "w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"       ,} )
              , _react2.default.createElement('input', {
                type: "text",
                value: agentSearch,
                onChange: (e) => setAgentSearch(e.target.value),
                placeholder: "Search agents..." ,
                className: "w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"          ,}
              )
            )
          )

          , _react2.default.createElement('div', { className: "flex-1 overflow-y-auto p-4"  ,}
            , _react2.default.createElement('div', { className: "space-y-2",}
              , filteredAgents.map(agentName => (
                _react2.default.createElement('div', {
                  key: agentName,
                  className: `group p-3 rounded-lg cursor-pointer transition-colors border ${
                    selectedAgent === agentName
                      ? 'bg-blue-50 border-blue-200'
                      : 'hover:bg-gray-50 border-transparent hover:border-gray-200'
                  }`,
                  onClick: () => setSelectedAgent(agentName),}

                  , _react2.default.createElement('div', { className: "flex items-center justify-between"  ,}
                    , _react2.default.createElement('span', { className: "font-medium text-gray-900" ,}, agentName)
                    , _react2.default.createElement('div', { className: "flex items-center space-x-1"  ,}
                      , _react2.default.createElement('button', {
                        onClick: (e) => {
                          e.stopPropagation();
                          editAgent(agentName);
                        },
                        className: "p-1 text-blue-500 hover:bg-blue-100 rounded transition-colors opacity-75 hover:opacity-100"     ,
                        title: "Edit agent" ,}

                        , _react2.default.createElement(_lucidereact.Edit3, { className: "w-4 h-4" ,} )
                      )
                      , _react2.default.createElement('button', {
                        onClick: (e) => {
                          e.stopPropagation();
                          deleteAgent(agentName);
                        },
                        className: "p-1 text-red-500 hover:bg-red-100 rounded transition-colors opacity-75 hover:opacity-100"     ,
                        title: "Delete agent" ,}

                        , _react2.default.createElement(_lucidereact.Trash2, { className: "w-4 h-4" ,} )
                      )
                    )
                  )
                  , _react2.default.createElement('p', { className: "text-sm text-gray-500 mt-1"  ,}
                    , Object.keys(hubConfig.agents[agentName].vars || {}).length, " variables"
                    , hubConfig.agents[agentName].output?.keys && Object.keys(hubConfig.agents[agentName].output.keys).length > 0 && (
                      _react2.default.createElement('span', null, "  ", Object.keys(hubConfig.agents[agentName].output.keys).length, " output keys")
                    )
                  )
                )
              ))
            )
          )
        )

        /* Middle Panel - Agent Details */
        , _react2.default.createElement('div', { className: "flex-1 flex flex-col"  ,}
          /* Header */
          , _react2.default.createElement('div', { className: "bg-white border-b border-gray-200 p-4"   ,}
            , _react2.default.createElement('div', { className: "flex items-center justify-between"  ,}
              , _react2.default.createElement('div', { className: "flex items-center space-x-3"  ,}
                , _react2.default.createElement('h1', { className: "text-xl font-bold text-gray-900"  ,}, "Agent: "
                   , selectedAgent || 'None Selected'
                )
                /* Delete Agent Button */
                , selectedAgent && (
                  _react2.default.createElement('button', {
                    onClick: () => deleteAgent(selectedAgent),
                    className: "p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors"    ,
                    title: "Delete agent" ,}

                    , _react2.default.createElement(_lucidereact.Trash2, { className: "w-5 h-5" ,} )
                  )
                )
              )
              
              /* Action Buttons */
              , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                , _react2.default.createElement('button', {
                  onClick: () => setMode(mode === 'edit' ? 'preview' : 'edit'),
                  className: `flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors text-sm ${
                    mode === 'edit'
                      ? 'bg-blue-100 text-blue-700 hover:bg-blue-200'
                      : 'bg-green-100 text-green-700 hover:bg-green-200'
                  }`,}

                  , mode === 'edit' ? _react2.default.createElement(_lucidereact.Eye, { className: "w-4 h-4" ,} ) : _react2.default.createElement(_lucidereact.Edit3, { className: "w-4 h-4" ,} )
                  , _react2.default.createElement('span', null, mode === 'edit' ? 'Preview' : 'Edit')
                )
                , _react2.default.createElement('button', {
                  onClick: executeAgent,
                  disabled: !selectedAgent || isExecuting,
                  className: "flex items-center space-x-2 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm"            ,}

                  , _react2.default.createElement(_lucidereact.Play, { className: `w-4 h-4 ${isExecuting ? 'animate-spin' : ''}`,} )
                  , _react2.default.createElement('span', null, isExecuting ? 'Executing...' : 'Execute')
                )
                , _react2.default.createElement('label', { className: "flex items-center space-x-2 px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors cursor-pointer text-sm"          , title: "Import Agent" ,}
                  , _react2.default.createElement(_lucidereact.Upload, { className: "w-4 h-4" ,} )
                  , _react2.default.createElement('span', { className: "hidden sm:inline",}, "Import")
                  , _react2.default.createElement('input', {
                    type: "file",
                    accept: ".json",
                    onChange: importAgentConfig,
                    className: "hidden",}
                  )
                )
                , _react2.default.createElement('button', {
                  onClick: exportAgentConfig,
                  disabled: !selectedAgent,
                  className: "flex items-center space-x-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm"          ,
                  title: "Export Agent" ,}

                  , _react2.default.createElement(_lucidereact.Download, { className: "w-4 h-4" ,} )
                  , _react2.default.createElement('span', { className: "hidden sm:inline",}, "Export")
                )
              )
            )
          )

          /* Agent Content */
          , _react2.default.createElement('div', { className: "flex-1 overflow-y-auto p-6"  ,}
            , selectedAgent && (
              _react2.default.createElement('div', { className: "space-y-6",}
                /* Template Section */
                , _react2.default.createElement('div', { className: "bg-white rounded-lg shadow-sm border border-gray-200 p-6"     ,}
                  , _react2.default.createElement('div', { 
                    className: "flex items-center space-x-2 mb-4 cursor-pointer hover:text-blue-600 transition-colors"      ,
                    onClick: () => handleFieldClick('template', currentAgent.template),}

                    , getFieldIcon('template')
                    , _react2.default.createElement('h3', { className: "text-lg font-semibold text-gray-900"  ,}, "Template")
                  )
                  , _react2.default.createElement('div', { className: "p-3 bg-gray-50 rounded-lg border font-mono text-sm"     ,}
                    , currentAgent.template || 'No template defined'
                  )
                )
                
                /* Executor Section */
                , _react2.default.createElement('div', { className: "bg-white rounded-lg shadow-sm border border-gray-200 p-6"     ,}
                  , _react2.default.createElement('div', { 
                    className: "flex items-center space-x-2 mb-4 cursor-pointer hover:text-blue-600 transition-colors"      ,
                    onClick: () => handleFieldClick('executor', currentAgent.executor),}

                    , getFieldIcon('executor')
                    , _react2.default.createElement('h3', { className: "text-lg font-semibold text-gray-900"  ,}, "Executor")
                  )
                  , _react2.default.createElement('div', { className: "space-y-2",}
                    , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Type:")
                      , _react2.default.createElement('span', { className: "text-sm text-gray-900" ,}, _optionalChain([currentAgent, 'access', _11 => _11.executor, 'optionalAccess', _12 => _12.type]) || 'Not configured')
                    )
                    , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "URL:")
                      , _react2.default.createElement('span', { className: "text-sm text-gray-900" ,}, _optionalChain([currentAgent, 'access', _13 => _13.executor, 'optionalAccess', _14 => _14.url]) || 'Not configured')
                    )
                  )
                )

                /* Output Section */
                , _react2.default.createElement('div', { className: "bg-white rounded-lg shadow-sm border border-gray-200 p-6"     ,}
                  , _react2.default.createElement('div', { 
                    className: "flex items-center space-x-2 mb-4 cursor-pointer hover:text-blue-600 transition-colors"      ,
                    onClick: () => handleFieldClick('output', currentAgent.output),}

                    , getFieldIcon('output')
                    , _react2.default.createElement('h3', { className: "text-lg font-semibold text-gray-900"  ,}, "Output")
                  )
                  , _react2.default.createElement('div', { className: "space-y-3",}
                    , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500"  ,}, "Type:")
                      , _react2.default.createElement('span', { className: `px-2 py-1 text-xs font-medium rounded-full ${
                        currentAgent.output?.type === 'json' ? 'bg-blue-100 text-blue-800' :
                        currentAgent.output?.type === 'text' ? 'bg-green-100 text-green-800' :
                        'bg-gray-100 text-gray-800'
                      }`,}
                        , currentAgent.output?.type || 'json'
                      )
                    )
                    , _react2.default.createElement('div', null
                      , _react2.default.createElement('span', { className: "text-sm font-medium text-gray-500 block mb-2"   ,}, "Keys:")
                      , _react2.default.createElement('div', { className: "space-y-2",}
                        , Object.entries(currentAgent.output?.keys || {}).map(([keyName, keyConfig]) => (
                          _react2.default.createElement('div', { key: keyName, className: "flex items-center justify-between p-2 bg-gray-50 rounded border"     ,}
                            , _react2.default.createElement('div', null
                              , _react2.default.createElement('span', { className: "font-medium text-sm" ,}, keyName)
                              , _react2.default.createElement('span', { className: `ml-2 px-2 py-0.5 text-xs rounded-full ${
                                keyConfig.type === 'string' ? 'bg-green-100 text-green-800' :
                                keyConfig.type === 'int' ? 'bg-blue-100 text-blue-800' :
                                keyConfig.type === 'bool' ? 'bg-purple-100 text-purple-800' :
                                'bg-gray-100 text-gray-800'
                              }`,}
                                , keyConfig.type
                              )
                              , keyConfig.description && (
                                _react2.default.createElement('p', { className: "text-xs text-gray-500 mt-1"  ,}, keyConfig.description)
                              )
                            )
                          )
                        ))
                        , (!currentAgent.output?.keys || Object.keys(currentAgent.output.keys).length === 0) && (
                          _react2.default.createElement('span', { className: "text-gray-500 text-sm"  ,}, "No output keys defined")
                        )
                      )
                    )
                  )
                )

                /* Variables Section */
                , _react2.default.createElement('div', { className: "bg-white rounded-lg shadow-sm border border-gray-200 p-6"     ,}
                  , _react2.default.createElement('div', { className: "flex items-center justify-between mb-4"   ,}
                    , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                      , getFieldIcon('vars')
                      , _react2.default.createElement('h3', { className: "text-lg font-semibold text-gray-900"  ,}, "Variables")
                    )
                    , mode === 'edit' && (
                      _react2.default.createElement('button', {
                        onClick: addVariable,
                        className: "flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors"          ,}

                        , _react2.default.createElement(_lucidereact.Plus, { className: "w-4 h-4" ,} )
                        , _react2.default.createElement('span', null, "Add Variable" )
                      )
                    )
                  )

                  , _react2.default.createElement('div', { className: "space-y-3",}
                    , Object.entries(currentAgent.vars || {}).map(([varName, varConfig]) => (
                      _react2.default.createElement('div', {
                        key: varName,
                        className: "p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors cursor-pointer group"       ,
                        onClick: () => handleFieldClick(`vars.${varName}`, varConfig),}

                        , _react2.default.createElement('div', { className: "flex items-center justify-between"  ,}
                          , _react2.default.createElement('div', { className: "flex items-center space-x-3"  ,}
                            , _react2.default.createElement('span', { className: "font-medium text-gray-900" ,}, varName)
                            , _react2.default.createElement('span', { className: `px-2 py-1 text-xs font-medium rounded-full ${
                              varConfig.type === 'text' ? 'bg-green-100 text-green-800' :
                              'bg-purple-100 text-purple-800'
                            }`,}
                              , varConfig.type
                            )
                          )
                          , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                            , varConfig.type === 'agent' && varConfig.agent && (
                              _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
                                , _react2.default.createElement('span', { className: "text-xs text-gray-500" ,}, " " , varConfig.agent)
                                , varConfig.key && (
                                  _react2.default.createElement('span', { className: "px-1 py-0.5 bg-yellow-100 text-yellow-800 text-xs rounded"    ,}
                                    , varConfig.key
                                  )
                                )
                                , _react2.default.createElement('button', {
                                  onClick: (e) => {
                                    e.stopPropagation();
                                    jumpToAgent(varConfig.agent);
                                  },
                                  className: "p-1 text-purple-600 hover:bg-purple-50 rounded"   ,
                                  title: "Jump to agent"  ,}

                                  , _react2.default.createElement(_lucidereact.ExternalLink, { className: "w-3 h-3" ,} )
                                )
                              )
                            )
                            , mode === 'edit' && (
                              _react2.default.createElement('div', { className: "flex items-center space-x-1"  ,}
                                , _react2.default.createElement('button', {
                                  onClick: (e) => {
                                    e.stopPropagation();
                                    editVariable(varName);
                                  },
                                  className: "p-1 text-blue-500 hover:bg-blue-100 rounded transition-colors opacity-75 hover:opacity-100"     ,
                                  title: "Edit variable" ,}

                                  , _react2.default.createElement(_lucidereact.Edit3, { className: "w-4 h-4" ,} )
                                )
                                , _react2.default.createElement('button', {
                                  onClick: (e) => {
                                    e.stopPropagation();
                                    removeVariable(varName);
                                  },
                                  className: "p-1 text-red-500 hover:bg-red-100 rounded transition-colors opacity-75 hover:opacity-100"     ,
                                  title: "Delete variable" ,}

                                  , _react2.default.createElement(_lucidereact.Trash2, { className: "w-4 h-4" ,} )
                                )
                              )
                            )
                          )
                        )
                        , _react2.default.createElement('div', { className: "mt-2 text-sm text-gray-600"  ,}
                          , varConfig.type === 'text' && varConfig.default && (
                            _react2.default.createElement('span', null, "Default: " , varConfig.default)
                          )
                          , varConfig.type === 'agent' && varConfig.agent && (
                            _react2.default.createElement('span', null, "Agent: " , varConfig.agent
                              , varConfig.key && _react2.default.createElement('span', null, " [", varConfig.key, "]")
                            )
                          )
                        )
                      )
                    ))
                  )
                )
              )
            )
          )
        )

        /* Right Panel - Dynamic Content */
        , _react2.default.createElement('div', { className: "w-96 bg-white border-l border-gray-200 flex flex-col"     ,}
          , _react2.default.createElement('div', { className: "p-4 border-b border-gray-200"  ,}
            , _react2.default.createElement('div', { className: "flex items-center space-x-2"  ,}
              , _react2.default.createElement(_lucidereact.Settings, { className: "w-5 h-5 text-gray-500"  ,} )
              , _react2.default.createElement('h2', { className: "text-lg font-semibold text-gray-900"  ,}, getRightPanelTitle())
            )
          )

          , _react2.default.createElement('div', { className: "flex-1 overflow-y-auto p-4"  ,}
            , renderRightPanelContent()
          )
        )
      )
    )
  );
};

exports. default = PandexAgentEditor;
</script></head>
  <body>
  

<div id="preview-app"></div>




</body></html>